Ch8 記憶體管理(memory management)
===

## 為什麼要記憶體管理?

「記憶體(memory)」為電腦暫時存放資料的地方。

當你在電腦上執行程式時，OS會將程式讀進記憶體中，你的電腦必須知道你的資料存放在什麼位置，這就是需要記憶體管理的原因。

## 變數地址的綁定時機

當一個電腦使用者寫了一支程式，

要執行這支程式大致上有三個步驟:

1. 由compiler編譯程式

2. 將程式讀進記憶體中

3. 執行程式

一支程式裡會有許多變數，

變數放在記憶體的位置稱為變數的地址。

決定變數地址的行為稱為綁定(address binding)，

那麼可以綁定變數地址的時機也就是上述說的三個時間點了:

1. **Compile time** (compiler編譯程式時即決定地址)

    在Compile time 就綁定地址，可能綁定到已經正在使用中的記憶體導致無法綁定。

2. **Load time** (將程式讀進記憶體時才決定地址)

    在Load time 綁定地址，如果綁定到已經正在使用中的記憶體，會改至其他位置，缺點是一旦確認位置後無法更改，除非程式重新讀取。

3. **Execution time** (程式的時間動態決定地址)

    在Execution time綁定地址是最有彈性的做法，位置可以隨時更改。
    
因為在「Compile time」和「Load time」綁定地址是沒有彈性的做法，

現在的OS幾乎是採用在Execution time綁定地址的做法。

## 虛擬地址的產生

因為OS是採用在Execution time綁定地址的做法，

所以使用者在寫程式時所看到的地址也僅僅是「虛擬地址」，

並不會看到變數真正放在記憶體的位置。


實際看一段C語言的程式碼，

程式碼相當簡單，

查看變數b的值和變數b的地址:
```
#include <stdio.h>

int main()
{
    int b = 2;

    printf("變數 b 的值：%d\n", b);
    printf("變數 b 的記憶體位址：%p\n", &b); //%p為印出地址的16進位表示法

    return 0;
}
```
